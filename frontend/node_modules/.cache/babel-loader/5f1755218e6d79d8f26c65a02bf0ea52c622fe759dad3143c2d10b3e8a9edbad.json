{"ast":null,"code":"import React from'react';import{useParams}from'react-router-dom';import axios from'axios';import SendFilesButton from'../components/SendFilesButton';import{handleError}from'../utils/errorHandler';import{jsx as _jsx}from\"react/jsx-runtime\";function SendFilesButtonContainer(_ref){let{files,setFiles,setSharedFiles,setInSendingProcess}=_ref;const{roomCode}=useParams();async function isThereEdgeCases(){if(files.length===0){alert('Add a file genius');return true;}try{const{data}=await axios.get(\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/check/\").concat(roomCode));if(!data.doesRoomExists){throw new Error('Room Does Not Exist Anymore');}}catch(error){handleError(error,error.message);return true;}return false;}async function handleSendingFiles(){setInSendingProcess(true);if(await isThereEdgeCases()){setInSendingProcess(false);return;}const formData=new FormData();for(const file of files){try{if(file.size>parseInt(process.env.REACT_APP_MAX_FILE_SIZE,10)){throw new Error('File is too large');}formData.append('file',file);const{data}=await axios.post(\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/upload/\").concat(roomCode),formData,{headers:{'Content-Type':'multipart/form-data'}});if(data.error){throw new Error(\"Failed to send files: \".concat(data.error));}setSharedFiles(prevSharedFiles=>[...prevSharedFiles,{filename:data.filename,fileURL:data.url}]);}catch(error){handleError(error,\"\".concat(file.name,\" failed to upload (check file size)\"));}finally{setFiles(prevFiles=>prevFiles.filter(f=>f!==file));}}setInSendingProcess(false);}return/*#__PURE__*/_jsx(SendFilesButton,{onClick:handleSendingFiles});}export default SendFilesButtonContainer;","map":{"version":3,"names":["React","useParams","axios","SendFilesButton","handleError","jsx","_jsx","SendFilesButtonContainer","_ref","files","setFiles","setSharedFiles","setInSendingProcess","roomCode","isThereEdgeCases","length","alert","data","get","concat","process","env","REACT_APP_API_BASE_URL","doesRoomExists","Error","error","message","handleSendingFiles","formData","FormData","file","size","parseInt","REACT_APP_MAX_FILE_SIZE","append","post","headers","prevSharedFiles","filename","fileURL","url","name","prevFiles","filter","f","onClick"],"sources":["C:/Users/WADREN/Desktop/brrr/react/myreactdd/frontend/src/containers/SendFilesButtonContainer.js"],"sourcesContent":["import React from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport axios from 'axios';\r\n\r\nimport SendFilesButton from '../components/SendFilesButton';\r\nimport { handleError } from '../utils/errorHandler';\r\n\r\nfunction SendFilesButtonContainer({ files, setFiles, setSharedFiles, setInSendingProcess }) {\r\n    const { roomCode } = useParams()\r\n\r\n    async function isThereEdgeCases() {\r\n      if (files.length === 0){\r\n        alert('Add a file genius')\r\n        return true\r\n      }\r\n      \r\n      try {\r\n        const { data } = await axios.get(`${process.env.REACT_APP_API_BASE_URL}/check/${roomCode}`)\r\n        \r\n        if (!data.doesRoomExists){\r\n          throw new Error('Room Does Not Exist Anymore')\r\n        }\r\n      } catch (error) {\r\n        handleError(error, error.message)\r\n        return true\r\n      }\r\n      \r\n      return false\r\n    }\r\n    \r\n    async function handleSendingFiles() {\r\n      setInSendingProcess(true)\r\n      \r\n      if (await isThereEdgeCases()) {\r\n        setInSendingProcess(false)\r\n        return\r\n      }\r\n      \r\n      const formData = new FormData();\r\n      \r\n      for (const file of files) {\r\n        try {\r\n          if (file.size > parseInt(process.env.REACT_APP_MAX_FILE_SIZE, 10)){\r\n            throw new Error('File is too large')\r\n          }\r\n\r\n          formData.append('file', file);\r\n          const { data} = await axios.post(`${process.env.REACT_APP_API_BASE_URL}/upload/${roomCode}`, formData, {\r\n            headers: { 'Content-Type': 'multipart/form-data' }\r\n          })\r\n    \r\n          if (data.error) {\r\n              throw new Error(`Failed to send files: ${data.error}`);\r\n          }\r\n           \r\n          setSharedFiles(prevSharedFiles => [\r\n            ...prevSharedFiles,\r\n            { filename: data.filename, fileURL: data.url }\r\n          ])   \r\n        } catch (error) {\r\n          handleError(error, `${file.name} failed to upload (check file size)`)\r\n        } finally {\r\n          setFiles(prevFiles => prevFiles.filter(f => f !== file))          \r\n        }\r\n      }\r\n      setInSendingProcess(false)\r\n    }\r\n\r\n  return (\r\n    <SendFilesButton onClick={handleSendingFiles} />\r\n  )\r\n}\r\n\r\nexport default SendFilesButtonContainer\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}